---
layout: single
title: PL/SQL
categories: SQL
tag: [cross, 레코드 수 문제]
---

1. #  PL/SQL
   PL/SQL은 데이터베이스에서 프로그래밍을 할 수 있게 만든 방식으로 pascal과 유사한 구조로서 DECLEAR ~ BEGIN ~ EXCEPTION ~ END 순서를 갖습니다.   

   ```SQL
      DECLARE SECTION(선언부)

      EXECUTABLE SECTION(실행부)

      EXCEPTION SECTION(예외 처리부)
   ```   

   선언부   
   모든 변수나 상수를 선언하는 부분으로서 DECLARE로 시작합니다.   

   실행부   
   절차적 형식으로 SQL문을 실행할 수 있도록 절차적 언어의 요소인 제어문, 반복문, 함수 정의 등 로직을 기술할 수 있는 부분   

   예외처리   
   PL/SQL 문이 실행되는 중에 에러가 발생할 수 있는데 이를 해결하기 위한 문장을 기술할 수 있는 부분   

1. # 구조
   1)PL/SQL 블록 내에서는 한 문장이 종료될 때마다 세미콜론(;)을 사용합니다.   
   2)END 뒤에 ;을 사용하여 하나의 블록이 끝났다는 것을 명시합니다.   
   3)단일행 주석은 --이고 여러행 주석은 /* */ 입니다.   
   4)변수에 값 할당시 := 를 사용합니다.   
   5)쿼리문을 실행하기 위해서는 END; 뒤에 / 가 있으면 종결된 것으로 간주합니다.   
   6)DECLEAR 변수선언 BEGIN 실행부 END; / 구조를 이룹니다.   
   
1. # SET SERVEROUTPUT ON
   오라클 환경 변수 SERVEROUTPUT는 오라클에서 제공해주는 프로시저를 사용하여 출력해 주는 내용을 화면에 보여주도록 설정하는 환경 변수인데 디폴트 값은 OFF이기 때문에 ON으로 변경해야 합니다.   

1. # 값 출력
   화면 출력을 위해서는 PUT_LINE이란 프로시저를 이용합니다. PUT_LINE은 오라클이 제공해주는 프로시저로 DBMS_OUTPUT 패키지에 묶여 있습니다.   
   ```SQL
      BEGIN
         DBMS_OUTPUT.PUT_LINE('hello world!');
      END;
      /
   ```   

   출력 값이 여러개인 경우   
   출력 값이 2개 이상이면 '||'로 묶어줘야 합니다.   
   ```SQL
       DBMS_OUTPUT.PUT_LINE(VEMPNO || '/' || VENAME);
   ```   

1. # SELECT ... INTO
   ```
      SELECT A, B INTO AA , BB FROM TABLE
   ```   
   TABLE에서 A의 결과를 AA에 대입하고, B의 결과를 BB에 대입합니다.   

1. # 스칼라 변수에 값 할당
   스칼라 변수 : SQL에서 사용하는 자료형으로 변수를 선언.   

   ```SQL
      SET SERVEROUTPUT ON
      DECLARE                  -- 선언부 시작
         VEMPNO NUMBER(4);     -- 변수 선언 : 스칼라 변수
         VENAME VARCHAR2(10);
      BEGIN                    -- 실행부 시작
         VEMPNO := 7788;
         VENAME := 'SCOTT';
         DBMS_OUTPUT.PUT_LINE(VEMPNO || '/' || VENAME);
      END;                     -- 실행부 끝
   ```

1. # 레퍼런스 변수에 값 할당
   레퍼런스 변수 : 이전에 선언된 다른 변수 또는 데이터베이스 컬럼에 맞추어 변수를 선언하기 위해 %TYPE속성을 사용.   

   ```SQL
      SET SERVEROUTPUT ON
      DECLARE
         VEMPNO EMP.EMPNO%TYPE;
         VENAME EMP.ENAME%TYPE;
      BEGIN
         
         SELECT EMPNO, ENAME INTO VEMPNO, VENAME FROM EMP
         WHERE ENAME = 'SCOTT';
         
         DBMS_OUTPUT.PUT_LINE('사번 / 이름');
         DBMS_OUTPUT.PUT_LINE('----------');
         DBMS_OUTPUT.PUT_LINE(VEMPNO || '/' || VENAME);
      END;
      /
   ```
1. # IF문
   IF ~ THEN ~ END IF

   ```

   ```
