---
layout: single
title: docker의 구조
categories: Docker
tag: []
---

1. # 도커의 구조
   
   도커의 위치확인
   ```s
      # which docker
      /usr/bin/docker
   ```   

   실행 중인 도커 프로세스   
   ```s
      ps aux | grep docker
      root 38549  0.0  2.2 1537176 87300  Ssl /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
   ```   
   컨테이너나 이미지를 다루는 명령어는 /usr/bin/docker에서 실행되지만 도커 엔진의 프로세스는 /usr/bin/dockerd 파일로 실행됩니다. 도커를 사용할 때 docker라는 명령어를 맨 앞에 붙여서 사용해왔는데, 이는 docker 명령어가 실제 도커 엔진이 아닌 클라이언트로서의 도커를 사용하겠다는 의미가 됩니다.   

1. # 서버와 클라이언트 도커
   2. ## 서버 도커
   실제로 컨테이너를 생성하고 실행하며 이미지를 관리하는 주체는 도커 서버이고, 이는 dockerd 프로세스로 동작합니다. 도커 엔진은 외부에서 API 입력을 받아 도커 엔진의 기능을 수행하는데, 도커 프로세스가 실행되어 서버로서 입력을 받을 준비가 된 상태를 도커 데몬이라고 이야기 합니다.

   2. ## 클라이언트 도커
   도커 데몬 API 입력을 받아 도커 엔진의 기능을 수행하는데, 이 API를 사용할 수 있도록 CLI를 제공하는 것이 도커 클라이너트입니다. 사용자가 docker로 시작하는 명령어를 입력하면 도커 클라이언트를 사용하는 것이며, 도커 클라이언트는 입력된 명령어를 로컬에 존재하는 도커 데몬에게 API로서 전달합니다. 이때 도커 클라언트는 /var/run/docker.sock에 위치한 유닉스 소켓을 통해 도커 데몬의 API를 호출합니다. 도커 클라이언트가 사용하는 유닉스 소켓은 같은 호스트 내에 있는 도커 데몬에게 명령을 전달할 때 사용됩니다.   

1. # 입력 과정
   터미널이나 puTTY 등으로 도커가 설치된 호스트에 접속해 docker 입력하면 진행되는 과정   

   1.사용자가 docker ps같은 명령어를 입력   

   2.`/usr/bin/docker`는 `/var/run/docker.sock` 유닉스 소켓을 사용해 도커 데몬에게 명령어를 전달   

   3.도커 데몬은 이 명령어를 파싱하고 명령어에 해당하는 작업을 수행   
   
   4.수행 결과를 도커 클라이언트에게 반환하고 사용자에게 결과를 출력    





